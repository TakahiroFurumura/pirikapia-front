import{Q as R}from"./QImg-BOBmlfsO.js";import{e as V,f as L,b as $,R as N,Q as y,g as z}from"./vm-DJoTChBZ.js";import{u as E,a as O}from"./use-dark-OjX2gg4y.js";import{c as j,g as A,a as s,h as u,s as M,B as P,r as b,b as F,w as K,O as S,G as h,E as c,M as G,S as J,D as v,C as B,F as Q,L as T,N as C,R as H,Q as U,I as W,J as p}from"./index-BjvWIdsZ.js";import{Q as I}from"./QCardSection-Db5NB2_V.js";import{Q as X}from"./QList-Fs36RfSu.js";import{Q as Y}from"./QCard-Cp9gwIMI.js";import{a as Z}from"./axios-DIrX_odN.js";import"./use-timeout-D2ET9EMK.js";const ee={xs:8,sm:10,md:14,lg:20,xl:24},te=j({name:"QChip",props:{...E,...V,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:_,emit:n}){const{proxy:{$q:l}}=A(),g=O(e,l),d=L(e,ee),m=s(()=>e.selected===!0||e.icon!==void 0),k=s(()=>e.selected===!0?e.iconSelected||l.iconSet.chip.selected:e.icon),q=s(()=>e.iconRemove||l.iconSet.chip.remove),r=s(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),a=s(()=>{const t=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(r.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(g.value===!0?" q-chip--dark q-dark":"")}),o=s(()=>{const t=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},x={...t,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||l.lang.label.remove};return{chip:t,remove:x}});function f(t){t.keyCode===13&&i(t)}function i(t){e.disable||(n("update:selected",!e.selected),n("click",t))}function w(t){(t.keyCode===void 0||t.keyCode===13)&&(M(t),e.disable===!1&&(n("update:modelValue",!1),n("remove")))}function D(){const t=[];r.value===!0&&t.push(u("div",{class:"q-focus-helper"})),m.value===!0&&t.push(u(y,{class:"q-chip__icon q-chip__icon--left",name:k.value}));const x=e.label!==void 0?[u("div",{class:"ellipsis"},[e.label])]:void 0;return t.push(u("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},z(_.default,x))),e.iconRight&&t.push(u(y,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&t.push(u(y,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:q.value,...o.value.remove,onClick:w,onKeyup:w})),t}return()=>{if(e.modelValue===!1)return;const t={class:a.value,style:d.value};return r.value===!0&&Object.assign(t,o.value.chip,{onClick:i,onKeyup:f}),$("div",t,D(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[N,e.ripple]])}}}),ae={class:"q-pa-md q-gutter-sm"},me=P({__name:"ImageDetailView",props:{imageId:{}},setup(e){const _=G(),n=e,l=b(null),g=b(!1),d=b(null),m=b([]);function k(a){return`/?tag=${a}`}const q=async()=>{await Z.get(`images/hashid/${n.imageId}/`).then(a=>{l.value=a.data,m.value=Object.keys(a.data.tags)}).catch(a=>{console.log(a)})},r=async()=>{g.value=!0,d.value=null,l.value=null;try{const a=await q();console.log(a)}catch(a){console.error("画像詳細の取得に失敗しました:",a),a instanceof Error?d.value=a:d.value=new Error(String(a))}finally{g.value=!1}};return F(()=>{r().catch(a=>console.error(a))}),K(()=>n.imageId,(a,o)=>{a!==o&&a&&(console.log(`Image ID changed from ${o} to ${a}. Reloading data.`),r().catch(f=>console.error(f)))}),(a,o)=>{const f=J("router-link");return v(),S("div",ae,[h(Y,{flat:""},{default:c(()=>[h(R,{src:l.value?.signed_url,"spinner-color":"white",style:{"max-width":"1024px"}},{default:c(()=>[l.value?.requires_login?(v(),S("div",{key:0,class:"absolute-full text-subtitle1 flex flex-center",style:{cursor:"pointer","background-color":"rgba(0, 0, 0, 0.3)",color:"white",padding:"2px"},onClick:o[0]||(o[0]=i=>T(_).push("/user-login"))},o[1]||(o[1]=[C("span",{class:""},"Login to unlock",-1)]))):Q("",!0)]),_:1},8,["src"]),m.value.length>0?(v(),B(I,{key:0},{default:c(()=>[(v(!0),S(H,null,U(m.value,i=>(v(),B(te,{color:"primary","text-color":"white",key:i},{default:c(()=>[h(f,{to:k(i),style:{"text-decoration":"none",color:"white"}},{default:c(()=>[W(p(i.replace(/_/g," ")),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})):Q("",!0),h(I,{class:"text-caption"},{default:c(()=>[h(X,{dense:""},{default:c(()=>[C("li",null,p(l.value?.filename),1),C("li",null,p(l.value?.created_on),1)]),_:1})]),_:1})]),_:1})])}}});export{me as default};
