import{Q as R}from"./QImg-vbP9VV7M.js";import{e as V,f as L,b as N,R as $,Q as q,g as z}from"./vm-DikqcM03.js";import{u as E,a as O}from"./use-dark-iUZlpSum.js";import{c as j,g as A,a as c,h as r,s as M,B as P,r as v,b as F,w as K,O as x,G as g,E as s,M as G,D as m,C as B,F as w,L as J,N as y,R as T,Q as H,I as U,J as S}from"./index-BcWUq69w.js";import{Q}from"./QCardSection-BqtR5ILF.js";import{Q as W}from"./QList-BBL7ErjG.js";import{Q as X}from"./QCard-Bo7G8JWD.js";import{a as Y}from"./axios-CaptQ5ct.js";import"./use-timeout-CgW_Fpkd.js";const Z={xs:8,sm:10,md:14,lg:20,xl:24},ee=j({name:"QChip",props:{...E,...V,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:b,emit:i}){const{proxy:{$q:l}}=A(),f=O(e,l),u=L(e,Z),d=c(()=>e.selected===!0||e.icon!==void 0),_=c(()=>e.selected===!0?e.iconSelected||l.iconSet.chip.selected:e.icon),h=c(()=>e.iconRemove||l.iconSet.chip.remove),a=c(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),o=c(()=>{const t=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(a.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(f.value===!0?" q-chip--dark q-dark":"")}),n=c(()=>{const t=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},k={...t,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||l.lang.label.remove};return{chip:t,remove:k}});function I(t){t.keyCode===13&&C(t)}function C(t){e.disable||(i("update:selected",!e.selected),i("click",t))}function p(t){(t.keyCode===void 0||t.keyCode===13)&&(M(t),e.disable===!1&&(i("update:modelValue",!1),i("remove")))}function D(){const t=[];a.value===!0&&t.push(r("div",{class:"q-focus-helper"})),d.value===!0&&t.push(r(q,{class:"q-chip__icon q-chip__icon--left",name:_.value}));const k=e.label!==void 0?[r("div",{class:"ellipsis"},[e.label])]:void 0;return t.push(r("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},z(b.default,k))),e.iconRight&&t.push(r(q,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&t.push(r(q,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:h.value,...n.value.remove,onClick:p,onKeyup:p})),t}return()=>{if(e.modelValue===!1)return;const t={class:o.value,style:u.value};return a.value===!0&&Object.assign(t,n.value.chip,{onClick:C,onKeyup:I}),N("div",t,D(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[$,e.ripple]])}}}),te={class:"q-pa-md q-gutter-sm"},de=P({__name:"ImageDetailView",props:{imageId:{}},setup(e){const b=G(),i=e,l=v(null),f=v(!1),u=v(null),d=v([]),_=async()=>{await Y.get(`images/hashid/${i.imageId}/`).then(a=>{l.value=a.data,d.value=Object.keys(a.data.tags)}).catch(a=>{console.log(a)})},h=async()=>{f.value=!0,u.value=null,l.value=null;try{const a=await _();console.log(a)}catch(a){console.error("画像詳細の取得に失敗しました:",a),a instanceof Error?u.value=a:u.value=new Error(String(a))}finally{f.value=!1}};return F(()=>{h().catch(a=>console.error(a))}),K(()=>i.imageId,(a,o)=>{a!==o&&a&&(console.log(`Image ID changed from ${o} to ${a}. Reloading data.`),h().catch(n=>console.error(n)))}),(a,o)=>(m(),x("div",te,[g(X,{flat:""},{default:s(()=>[g(R,{src:l.value?.signed_url,"spinner-color":"white",style:{"max-width":"1024px"}},{default:s(()=>[l.value?.requires_login?(m(),x("div",{key:0,class:"absolute-full text-subtitle1 flex flex-center",style:{cursor:"pointer","background-color":"rgba(0, 0, 0, 0.3)",color:"white",padding:"2px"},onClick:o[0]||(o[0]=n=>J(b).push("/user-login"))},o[1]||(o[1]=[y("span",{class:""},"Login to unlock",-1)]))):w("",!0)]),_:1},8,["src"]),d.value.length>0?(m(),B(Q,{key:0},{default:s(()=>[(m(!0),x(T,null,H(d.value,n=>(m(),B(ee,{color:"primary","text-color":"white",key:n},{default:s(()=>[U(S(n.replace(/_/g," ")),1)]),_:2},1024))),128))]),_:1})):w("",!0),g(Q,{class:"text-caption"},{default:s(()=>[g(W,{dense:""},{default:s(()=>[y("li",null,S(l.value?.filename),1),y("li",null,S(l.value?.created_on),1)]),_:1})]),_:1})]),_:1})]))}});export{de as default};
