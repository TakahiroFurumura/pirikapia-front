import{Q as B,b as q}from"./interfaces-Bku749pw.js";import{Q}from"./QSeparator-EYR4Kaaj.js";import{Q as c}from"./QBtn-BI7MwTIZ.js";import{Q as h}from"./QCard-mhFZGvGd.js";import{L as C,a as n,r as $,I as w,M as N,N as d,O as o,Q as t,$ as S,X as T,P as V,W as i,R as f,S as u,V as A}from"./index-BJX9CnoD.js";import{u as I,a as M}from"./auth-Dd1rHt8x.js";const z={key:0,class:"absolute-bottom text-center",style:{"background-color":"rgba(0, 0, 0, 0.3)",color:"white",padding:"2px"}},D={class:"text-caption q-ml-sm"},P=C({__name:"ImageThumbnail",props:{filename:{},image_id:{},signed_url:{},owner_username:{},title:{default:""},comment_count:{default:0},requires_login:{type:Boolean},bookmark:{type:Boolean},bookmark_count:{default:0}},setup(k){const p=A(),s=I(),e=k,_=n(()=>e.bookmark_count+(m.value?1:0)),m=$(!1),l=n(()=>e.bookmark!=null?!1:e.bookmark),g=n(()=>l.value||e.bookmark_count>0?"favorite":"favorite_border"),b=n(()=>l.value?"pink":"primary");function v(){return`/image-detail-view/${e.image_id}`}function y(){l.value||(console.debug(`toggleBookmark ${e.filename} ${s.user}`),s.isAuthenticated?M.post(`images/bookmark/${e.image_id}/`,{}).then(a=>{console.debug(`${a.status} ${e.filename} was added to ${s.user.username} bookmark.`),m.value=!0}).catch(a=>{console.error(a.message)}):p.push("/user-login"))}return w(()=>{}),(a,r)=>{const x=S("router-link");return d(),N(h,{flat:"",class:"q-ma-none q-pa-none",style:{cursor:"pointer"}},{default:o(()=>[t(x,{to:v()},{default:o(()=>[t(B,{src:e.signed_url,ratio:1/1,style:{position:"relative"}},{error:o(()=>r[0]||(r[0]=[i("div",{class:"absolute-full flex flex-center bg-grey text-white"}," Failed to load... ",-1)])),default:o(()=>[a.requires_login?(d(),T("div",z,r[1]||(r[1]=[i("span",{class:"text-caption"},"Login to unlock",-1)]))):V("",!0)]),_:1},8,["src"])]),_:1},8,["to"]),t(Q),t(q,{align:"left",class:"q-mx-none q-pa-none q-my-none"},{default:o(()=>[t(c,{flat:"",round:"",size:"md",color:b.value,icon:g.value,class:"q-ml-none",onClick:y},{default:o(()=>[f(u(_.value),1)]),_:1},8,["color","icon"]),t(c,{flat:"",round:"",size:"md",color:"primary",icon:"comment",class:"q-ml-sm"},{default:o(()=>[f(u(e.comment_count),1)]),_:1}),i("div",D,"by "+u(e.owner_username),1)]),_:1})]),_:1})}}});export{P as _};
