import{Q as k,b as Q}from"./interfaces-mmqTB_Cm.js";import{Q as C}from"./QSeparator-DHJMw6a2.js";import{Q as p}from"./QBtn-Cgmgakfy.js";import{Q as $}from"./QCard-Dgu91nSk.js";import{I as T,a as n,r as N,F as S,J as d,K as r,L as t,M as l,U as _,N as s,Q as A,T as i,O as b,P as c,S as I}from"./index-7caSP31t.js";import{u as V,a as F}from"./auth-CDSO7_SK.js";const M={key:1},z={key:2,class:"absolute-bottom text-center",style:{"background-color":"rgba(0, 0, 0, 0.3)",color:"white",padding:"2px"}},D={class:"text-caption q-ml-sm"},P=T({__name:"ImageThumbnail",props:{filename:{},image_id:{},signed_url:{},owner_username:{},title:{default:""},comment_count:{default:0},requires_login:{type:Boolean},bookmark:{type:Boolean},bookmark_count:{default:0},show_buttons:{type:Boolean,default:!0},disable_link:{type:Boolean,default:!1}},setup(g){const v=I(),u=V(),e=g,y=n(()=>e.bookmark_count+(f.value?1:0)),f=N(!1),m=n(()=>e.bookmark!=null?!1:e.bookmark),B=n(()=>m.value||e.bookmark_count>0?"favorite":"favorite_border"),h=n(()=>m.value?"pink":"primary");function x(){return`/image-detail-view/${e.image_id}`}function q(){m.value||(console.debug(`toggleBookmark ${e.filename} ${u.user}`),u.isAuthenticated?F.post(`images/bookmark/${e.image_id}/`,{}).then(o=>{console.debug(`${o.status} ${e.filename} was added to ${u.user.username} bookmark.`),f.value=!0}).catch(o=>{console.error(o.message)}):v.push("/user-login"))}return S(()=>{}),(o,a)=>{const w=A("router-link");return r(),d($,{flat:"",class:"q-ma-none q-pa-none",style:{cursor:"pointer"}},{default:t(()=>[o.disable_link?l("",!0):(r(),d(w,{key:0,to:x()},{default:t(()=>[s(k,{src:e.signed_url,ratio:1/1,style:{position:"relative"}},{error:t(()=>a[0]||(a[0]=[i("div",{class:"absolute-full flex flex-center bg-grey text-white"}," Failed to load... ",-1)])),_:1},8,["src"])]),_:1},8,["to"])),o.disable_link?(r(),_("div",M,[s(k,{src:e.signed_url,ratio:1/1,style:{position:"relative"}},{error:t(()=>a[1]||(a[1]=[i("div",{class:"absolute-full flex flex-center bg-grey text-white"}," Failed to load... ",-1)])),_:1},8,["src"])])):l("",!0),o.requires_login?(r(),_("div",z,a[2]||(a[2]=[i("span",{class:"text-caption"},"Login to unlock",-1)]))):l("",!0),s(C),o.show_buttons?(r(),d(Q,{key:3,align:"left",class:"q-mx-none q-pa-none q-my-none"},{default:t(()=>[s(p,{flat:"",round:"",size:"md",color:h.value,icon:B.value,class:"q-ml-none",onClick:q},{default:t(()=>[b(c(y.value),1)]),_:1},8,["color","icon"]),s(p,{flat:"",round:"",size:"md",color:"primary",icon:"comment",class:"q-ml-sm"},{default:t(()=>[b(c(e.comment_count),1)]),_:1}),i("div",D,"by "+c(e.owner_username),1)]),_:1})):l("",!0)]),_:1})}}});export{P as _};
