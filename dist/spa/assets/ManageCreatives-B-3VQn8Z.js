import{Q as P}from"./QChip-DYjRA0xl.js";import{Q as I}from"./QSpinnerGears-FhtbVfVl.js";import{Q as b}from"./QPagination-C87-Nozn.js";import{Q as N}from"./QBtn-Cgmgakfy.js";import{Q as S}from"./QPage-ltYmKs_4.js";import{u as A,a as q}from"./auth-CDSO7_SK.js";import{_ as B}from"./ImageThumbnail.vue_vue_type_script_setup_true_lang-DJ3E9ctd.js";import{a as E}from"./interfaces-mmqTB_Cm.js";import{I as M,r as s,a as T,w as F,F as L,J as U,L as k,Y as $,K as t,U as n,M as l,T as m,N as u,O as R,P as C,R as y,Q as z,X as D,V as G}from"./index-7caSP31t.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-router-link-DHbFeyIZ.js";import"./use-dark-B3FPmzRe.js";import"./QInput-DvQSfkEM.js";import"./use-key-composition-wWDVTXM6.js";import"./format-BvkBI9bc.js";import"./QSeparator-DHJMw6a2.js";import"./QCard-Dgu91nSk.js";import"./use-timeout-CyMzVV9z.js";const K={key:0},O={class:"raw"},X={key:0},Y={key:1},j={key:0,class:"text-center"},H={class:"q-pa-md flex flex-center"},W={key:1,class:"text-negative text-center"},Z={key:2,class:"text-center"},ee={key:3,class:"row q-col-gutter-xs"},oe={class:"q-pa-md flex flex-center"},ae=M({__name:"ManageCreatives",setup(te){const d=s([]),i=s(!0),r=s(null),p=A(),_=$(),v=s(""),Q=T(()=>typeof _.query.tag=="string"),f=s(1),g=s(30),c=s(1);F(c,()=>{w()});const x=async()=>{console.debug("url query parameters",_.query),i.value=!0,r.value=null,v.value=`/images/search/?owner=${p.user.pk}&orderby=-created_on&n=${g.value}&offset=${((c.value-1)*g.value).toString()}`;try{await q.get(v.value).then(e=>{const a=e.data;d.value=a.map(h=>E(h))})}catch(e){console.error("Failed to fetch image data:",e),e instanceof Error?r.value=e:r.value=new Error("An unknown error occurred")}finally{i.value=!1}},V=async()=>{try{await q.get(v.value.replace("search/","search/count/")).then(e=>{const a=e.data.count;f.value=Math.ceil(a/g.value)})}catch(e){console.error("Failed to fetch image data:",e),e instanceof Error?r.value=e:r.value=new Error("An unknown error occurred")}finally{i.value=!1}};function w(){x().then(()=>{V()}).catch(e=>console.error(e))}return L(()=>{w()}),(e,a)=>{const h=z("router-link");return t(),U(S,{class:"q-pa-sm"},{default:k(()=>[Q.value?(t(),n("div",K,[u(P,{color:"primary","text-color":"white"},{default:k(()=>[R(C(y(_).query.tag),1)]),_:1})])):l("",!0),m("div",O,[u(h,{to:"/user-login"},{default:k(()=>[y(p).isAuthenticated?l("",!0):(t(),n("div",X," Log in to view your bookmark "))]),_:1})]),y(p).isAuthenticated?(t(),n("div",Y,[i.value?(t(),n("div",j,[u(I,{size:"50px",color:"primary"}),a[2]||(a[2]=m("p",null,"Loading...",-1))])):l("",!0),m("div",H,[u(b,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=o=>c.value=o),max:f.value,input:""},null,8,["modelValue","max"])]),r.value?(t(),n("div",W,[m("p",null,"failed to load images "+C(r.value.message),1),u(N,{label:"reload",color:"primary",onClick:x})])):l("",!0),!i.value&&!r.value&&d.value.length===0?(t(),n("div",Z,a[3]||(a[3]=[m("p",null,"No images found",-1)]))):l("",!0),!i.value&&!r.value&&d.value.length>0?(t(),n("div",ee,[(t(!0),n(D,null,G(d.value,o=>(t(),n("div",{key:o.filename,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[u(B,{filename:o.filename,image_id:o.image_id,signed_url:o.signed_url,owner_username:o.owner_username,title:o.title,comment_count:o.comment_count,requires_login:o.requires_login,bookmark:o.bookmark,bookmark_count:o.bookmark_count},null,8,["filename","image_id","signed_url","owner_username","title","comment_count","requires_login","bookmark","bookmark_count"])]))),128))])):l("",!0),m("div",oe,[u(b,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=o=>c.value=o),max:f.value},null,8,["modelValue","max"])])])):l("",!0)]),_:1})}}}),we=J(ae,[["__scopeId","data-v-676984f4"]]);export{we as default};
