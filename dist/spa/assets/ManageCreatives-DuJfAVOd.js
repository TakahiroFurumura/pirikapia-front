import{b as Z,a as O,d as ee,Q as R}from"./QBtn-C4amj06Z.js";import{Q as ae}from"./QInput-DBV83mZo.js";import{u as te,a as le}from"./use-dark-CsNMFGTn.js";import{c as ne,d as oe,a as n,r as y,w as K,h as F,x as ue,L as ie,I as re,M as se,O as Q,a0 as ce,N as m,W as P,X as f,P as x,Q as p,R as de,S as j,U as L,$ as me,_ as ve,Y as ge}from"./index-Iejlj0YL.js";import{b as fe}from"./format-BvkBI9bc.js";import{Q as be}from"./QChip-BKpr9KhP.js";import{Q as ye}from"./QSpinnerGears-QkwF1b3R.js";import{Q as he}from"./QPage-DCZRaFrD.js";import{u as _e,a as U}from"./auth-C-Bd6L6z.js";import{_ as ke}from"./ImageThumbnail.vue_vue_type_script_setup_true_lang-Ch1lf90q.js";import{a as xe}from"./interfaces-DarSW5Jb.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-router-link-CL0TLQCd.js";import"./use-key-composition-v1xf7Vwr.js";import"./private.use-form-KFE5Bbc1.js";import"./QSeparator-Dvfmp6IP.js";import"./QCard-iQYYtHnQ.js";import"./use-timeout-BxJrE4U8.js";function I(e,b){return[!0,!1].includes(e)?e:b}const z=ne({name:"QPagination",props:{...te,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>(typeof e=="string"?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>e===""||Z.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:b}){const{proxy:v}=oe(),{$q:o}=v,C=le(e,o),i=n(()=>parseInt(e.min,10)),u=n(()=>parseInt(e.max,10)),M=n(()=>parseInt(e.maxPages,10)),S=n(()=>l.value+" / "+u.value),w=n(()=>I(e.boundaryLinks,e.input)),c=n(()=>I(e.boundaryNumbers,!e.input)),$=n(()=>I(e.directionLinks,e.input)),V=n(()=>I(e.ellipses,!e.input)),h=y(null),l=n({get:()=>e.modelValue,set:a=>{if(a=parseInt(a,10),e.disable||isNaN(a))return;const t=fe(a,i.value,u.value);e.modelValue!==t&&b("update:modelValue",t)}});K(()=>`${i.value}|${u.value}`,()=>{l.value=e.modelValue});const s=n(()=>"q-pagination row no-wrap items-center"+(e.disable===!0?" disabled":"")),_=n(()=>e.gutter in O?`${O[e.gutter]}px`:e.gutter||null),r=n(()=>_.value!==null?`--q-pagination-gutter-parent:-${_.value};--q-pagination-gutter-child:${_.value}`:null),E=n(()=>{const a=[e.iconFirst||o.iconSet.pagination.first,e.iconPrev||o.iconSet.pagination.prev,e.iconNext||o.iconSet.pagination.next,e.iconLast||o.iconSet.pagination.last];return o.lang.rtl===!0?a.reverse():a}),W=n(()=>({"aria-disabled":e.disable===!0?"true":"false",role:"navigation"})),T=n(()=>ee(e,"flat")),G=n(()=>({[T.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:e.ripple!==null?e.ripple:!0})),X=n(()=>{const a={[T.value]:!1};return e.activeDesign!==""&&(a[e.activeDesign]=!0),a}),Y=n(()=>({...X.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor})),B=n(()=>{let a=Math.max(M.value,1+(V.value?2:0)+(c.value?2:0));const t={pgFrom:i.value,pgTo:u.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(u.value).length)}em`}};return M.value&&a<u.value-i.value+1&&(a=1+Math.floor(a/2)*2,t.pgFrom=Math.max(i.value,Math.min(u.value-a+1,e.modelValue-Math.floor(a/2))),t.pgTo=Math.min(u.value,t.pgFrom+a-1),c.value&&(t.boundaryStart=!0,t.pgFrom++),V.value&&t.pgFrom>i.value+(c.value?1:0)&&(t.ellipsesStart=!0,t.pgFrom++),c.value&&(t.boundaryEnd=!0,t.pgTo--),V.value&&t.pgTo<u.value-(c.value?1:0)&&(t.ellipsesEnd=!0,t.pgTo--)),t});function D(a){l.value=a}function H(a){l.value=l.value+a}const J=n(()=>{function a(){l.value=h.value,h.value=null}return{"onUpdate:modelValue":t=>{h.value=t},onKeyup:t=>{ue(t,13)===!0&&a()},onBlur:a}});function g(a,t,q){const k={"aria-label":t,"aria-current":"false",...G.value,...a};return q===!0&&Object.assign(k,{"aria-current":"true",...Y.value}),t!==void 0&&(e.toFn!==void 0?k.to=e.toFn(t):k.onClick=()=>{D(t)}),F(R,k)}return Object.assign(v,{set:D,setByOffset:H}),()=>{const a=[],t=[];let q;if(w.value===!0&&(a.push(g({key:"bls",disable:e.disable||e.modelValue<=i.value,icon:E.value[0],"aria-label":o.lang.pagination.first},i.value)),t.unshift(g({key:"ble",disable:e.disable||e.modelValue>=u.value,icon:E.value[3],"aria-label":o.lang.pagination.last},u.value))),$.value===!0&&(a.push(g({key:"bdp",disable:e.disable||e.modelValue<=i.value,icon:E.value[1],"aria-label":o.lang.pagination.prev},e.modelValue-1)),t.unshift(g({key:"bdn",disable:e.disable||e.modelValue>=u.value,icon:E.value[2],"aria-label":o.lang.pagination.next},e.modelValue+1))),e.input!==!0){q=[];const{pgFrom:k,pgTo:A,marginalStyle:N}=B.value;if(B.value.boundaryStart===!0){const d=i.value===e.modelValue;a.push(g({key:"bns",style:N,disable:e.disable,label:i.value},i.value,d))}if(B.value.boundaryEnd===!0){const d=u.value===e.modelValue;t.unshift(g({key:"bne",style:N,disable:e.disable,label:u.value},u.value,d))}B.value.ellipsesStart===!0&&a.push(g({key:"bes",style:N,disable:e.disable,label:"…",ripple:!1},k-1)),B.value.ellipsesEnd===!0&&t.unshift(g({key:"bee",style:N,disable:e.disable,label:"…",ripple:!1},A+1));for(let d=k;d<=A;d++)q.push(g({key:`bpg${d}`,style:N,disable:e.disable,label:d},d,d===e.modelValue))}return F("div",{class:s.value,...W.value},[F("div",{class:"q-pagination__content row no-wrap items-center",style:r.value},[...a,e.input===!0?F(ae,{class:"inline",style:{width:`${S.value.length/1.5}em`},type:"number",dense:!0,value:h.value,disable:e.disable,dark:C.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:S.value,min:i.value,max:u.value,...J.value}):F("div",{class:"q-pagination__middle row justify-center"},q),...t])])}}}),Se={class:"q-pa-md flex flex-center"},Pe={key:0},Ce={key:1,class:"text-center"},we={class:"raw"},Ve={key:0},Be={key:2},qe={key:0,class:"text-negative text-center"},Ne={key:1,class:"text-center"},Fe={key:2,class:"row q-col-gutter-xs"},Me={class:"q-pa-md flex flex-center"},$e=ie({__name:"ManageCreatives",setup(e){const b=y([]),v=y(!0),o=y(null),C=_e(),i=ce(),u=y(""),M=n(()=>typeof i.query.tag=="string"),S=y(1),w=y(30),c=y(1);K(c,()=>{h()});const $=async()=>{console.debug("url query parameters",i.query),v.value=!0,o.value=null,u.value=`/images/search/?owner=${C.user.pk}&orderby=-created_on&n=${w.value}&offset=${((c.value-1)*w.value).toString()}`;try{await U.get(u.value).then(l=>{const s=l.data;b.value=s.map(_=>xe(_))})}catch(l){console.error("Failed to fetch image data:",l),l instanceof Error?o.value=l:o.value=new Error("An unknown error occurred")}finally{v.value=!1}},V=async()=>{try{await U.get(u.value.replace("search/","search/count/")).then(l=>{const s=l.data.count;S.value=Math.ceil(s/w.value)})}catch(l){console.error("Failed to fetch image data:",l),l instanceof Error?o.value=l:o.value=new Error("An unknown error occurred")}finally{v.value=!1}};function h(){$().then(()=>{V()}).catch(l=>console.error(l))}return re(()=>{h()}),(l,s)=>{const _=me("router-link");return m(),se(he,{class:"q-pa-sm"},{default:Q(()=>[P("div",Se,[p(z,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=r=>c.value=r),max:S.value,input:""},null,8,["modelValue","max"])]),M.value?(m(),f("div",Pe,[p(be,{color:"primary","text-color":"white"},{default:Q(()=>[de(j(L(i).query.tag),1)]),_:1})])):x("",!0),v.value?(m(),f("div",Ce,[p(ye,{size:"50px",color:"primary"}),s[2]||(s[2]=P("p",null,"Loading...",-1))])):x("",!0),P("div",we,[p(_,{to:"/user-login"},{default:Q(()=>[L(C).isAuthenticated?x("",!0):(m(),f("div",Ve," Log in to view your bookmark "))]),_:1})]),L(C).isAuthenticated?(m(),f("div",Be,[o.value?(m(),f("div",qe,[P("p",null,"failed to load images "+j(o.value.message),1),p(R,{label:"reload",color:"primary",onClick:$})])):x("",!0),!v.value&&!o.value&&b.value.length===0?(m(),f("div",Ne,s[3]||(s[3]=[P("p",null,"No images found",-1)]))):x("",!0),!v.value&&!o.value&&b.value.length>0?(m(),f("div",Fe,[(m(!0),f(ve,null,ge(b.value,r=>(m(),f("div",{key:r.filename,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[p(ke,{filename:r.filename,image_id:r.image_id,signed_url:r.signed_url,owner_username:r.owner_username,title:r.title,comment_count:r.comment_count,requires_login:r.requires_login,bookmark:r.bookmark,bookmark_count:r.bookmark_count},null,8,["filename","image_id","signed_url","owner_username","title","comment_count","requires_login","bookmark","bookmark_count"])]))),128))])):x("",!0)])):x("",!0),P("div",Me,[p(z,{modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=r=>c.value=r),max:S.value},null,8,["modelValue","max"])])]),_:1})}}}),Je=pe($e,[["__scopeId","data-v-631f25d6"]]);export{Je as default};
