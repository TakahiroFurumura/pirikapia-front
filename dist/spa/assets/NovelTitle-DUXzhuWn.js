import{u as z,d as H,a as K,h as J,Q as Y}from"./use-router-link-B_O56vdA.js";import{u as G,a as W}from"./use-dark-DQdLCcCG.js";import{r as I,a as i,h as p,g as X,a2 as h,q as A,c as Z,w as M,e as ee,b as te,a3 as oe,I as ne,F as le,Y as ae,J as re,L as ue,K as S,U as se,M as ie,T as ce,N as q,S as de}from"./index-DIZdvslo.js";import{d as fe,k as me}from"./use-key-composition-ClTwYej7.js";import{Q as ve}from"./QPage-CPZYKsue.js";import{u as pe,a as ge}from"./auth-XbfXqh8a.js";import{u as he}from"./uiconfig-t9C1pZ6V.js";import{e as be}from"./extend-DTfK50KV.js";import{_ as ke}from"./NovelCover.vue_vue_type_script_setup_true_lang-BXN6itjU.js";import{c as Ie}from"./interfaces-D9GRGoMu.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QBtn-CZIcCi6_.js";import"./QSeparator-DiIsg1sc.js";import"./QCardSection-D1bofxnj.js";import"./QCard-D1ll5pcf.js";import"./QDialog-BBJo7vML.js";import"./use-timeout-CyDOrok_.js";import"./focusout-BjVkqlMj.js";import"./scroll-DHKrocWs.js";import"./ImageBox.vue_vue_type_script_setup_true_lang-nQ361zjr.js";import"./QChip-CHiRG0CG.js";import"./QInput-mqHnNfJz.js";import"./QPagination-BmOKz_L2.js";import"./format-BvkBI9bc.js";import"./QSpinnerGears-DMMaUny_.js";import"./ImageThumbnail.vue_vue_type_script_setup_true_lang-CCpL8UuX.js";function _e(t,o){const e=I(null),l=i(()=>t.disable===!0?null:p("span",{ref:e,class:"no-outline",tabindex:-1}));function n(a){const r=o.value;a?.qAvoidFocus!==!0&&(a?.type.indexOf("key")===0?document.activeElement!==r&&r?.contains(document.activeElement)===!0&&r.focus():e.value!==null&&(a===void 0||r?.contains(a.target)===!0)&&e.value.focus())}return{refocusTargetEl:l,refocusTarget:n}}const Ce={xs:30,sm:35,md:40,lg:50,xl:60},ye={...G,...z,...fe,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:t=>t==="tf"||t==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},Te=["update:modelValue"];function Ve(t,o){const{props:e,slots:l,emit:n,proxy:a}=X(),{$q:r}=a,s=W(e,r),_=I(null),{refocusTargetEl:m,refocusTarget:b}=_e(e,_),g=H(e,Ce),c=i(()=>e.val!==void 0&&Array.isArray(e.modelValue)),f=i(()=>{const u=h(e.val);return c.value===!0?e.modelValue.findIndex(v=>h(v)===u):-1}),d=i(()=>c.value===!0?f.value!==-1:h(e.modelValue)===h(e.trueValue)),y=i(()=>c.value===!0?f.value===-1:h(e.modelValue)===h(e.falseValue)),V=i(()=>d.value===!1&&y.value===!1),j=i(()=>e.disable===!0?-1:e.tabindex||0),N=i(()=>`q-${t} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(s.value===!0?` q-${t}--dark`:"")+(e.dense===!0?` q-${t}--dense`:"")+(e.leftLabel===!0?" reverse":"")),P=i(()=>{const u=d.value===!0?"truthy":y.value===!0?"falsy":"indet",v=e.color!==void 0&&(e.keepColor===!0||d.value===!0)?` text-${e.color}`:"";return`q-${t}__inner relative-position non-selectable q-${t}__inner--${u}${v}`}),B=i(()=>{const u={type:"checkbox"};return e.name!==void 0&&Object.assign(u,{".checked":d.value,"^checked":d.value===!0?"checked":void 0,name:e.name,value:c.value===!0?e.val:e.trueValue}),u}),L=me(B),U=i(()=>{const u={tabindex:j.value,role:"switch","aria-label":e.label,"aria-checked":V.value===!0?"mixed":d.value===!0?"true":"false"};return e.disable===!0&&(u["aria-disabled"]="true"),u});function T(u){u!==void 0&&(A(u),b(u)),e.disable!==!0&&n("update:modelValue",F(),u)}function F(){if(c.value===!0){if(d.value===!0){const u=e.modelValue.slice();return u.splice(f.value,1),u}return e.modelValue.concat([e.val])}if(d.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(y.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function R(u){(u.keyCode===13||u.keyCode===32)&&A(u)}function D(u){(u.keyCode===13||u.keyCode===32)&&T(u)}const Q=o(d,V);return Object.assign(a,{toggle:T}),()=>{const u=Q();e.disable!==!0&&L(u,"unshift",` q-${t}__native absolute q-ma-none q-pa-none`);const v=[p("div",{class:P.value,style:g.value,"aria-hidden":"true"},u)];m.value!==null&&v.push(m.value);const x=e.label!==void 0?K(l.default,[e.label]):J(l.default);return x!==void 0&&v.push(p("div",{class:`q-${t}__label q-anchor--skip`},x)),p("div",{ref:_,class:N.value,...U.value,onClick:T,onKeydown:R,onKeyup:D},v)}}const xe=Z({name:"QToggle",props:{...ye,icon:String,iconColor:String},emits:Te,setup(t){function o(e,l){const n=i(()=>(e.value===!0?t.checkedIcon:l.value===!0?t.indeterminateIcon:t.uncheckedIcon)||t.icon),a=i(()=>e.value===!0?t.iconColor:null);return()=>[p("div",{class:"q-toggle__track"}),p("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},n.value!==void 0?[p(Y,{name:n.value,color:a.value})]:void 0)]}return Ve("toggle",o)}});let C=null,$;const w=[];function Ae(t){t.title&&(t.title=t.titleTemplate?t.titleTemplate(t.title):t.title,delete t.titleTemplate),[["meta","content"],["link","href"]].forEach(o=>{const e=t[o[0]],l=o[1];for(const n in e){const a=e[n];a.template&&(Object.keys(a).length===1?delete e[n]:(a[l]=a.template(a[l]||""),delete a.template))}})}function Se(t,o){if(Object.keys(t).length!==Object.keys(o).length)return!0;for(const e in t)if(t[e]!==o[e])return!0}function E(t){return["class","style"].includes(t)===!1}function O(t){return["lang","dir"].includes(t)===!1}function qe(t,o){const e={},l={};return t===void 0?{add:o,remove:l}:(t.title!==o.title&&(e.title=o.title),["meta","link","script","htmlAttr","bodyAttr"].forEach(n=>{const a=t[n],r=o[n];if(l[n]=[],a==null){e[n]=r;return}e[n]={};for(const s in a)r.hasOwnProperty(s)===!1&&l[n].push(s);for(const s in r)a.hasOwnProperty(s)===!1?e[n][s]=r[s]:Se(a[s],r[s])===!0&&(l[n].push(s),e[n][s]=r[s])}),{add:e,remove:l})}function $e({add:t,remove:o}){t.title&&(document.title=t.title),Object.keys(o).length!==0&&(["meta","link","script"].forEach(e=>{o[e].forEach(l=>{document.head.querySelector(`${e}[data-qmeta="${l}"]`).remove()})}),o.htmlAttr.filter(O).forEach(e=>{document.documentElement.removeAttribute(e)}),o.bodyAttr.filter(E).forEach(e=>{document.body.removeAttribute(e)})),["meta","link","script"].forEach(e=>{const l=t[e];for(const n in l){const a=document.createElement(e);for(const r in l[n])r!=="innerHTML"&&a.setAttribute(r,l[n][r]);a.setAttribute("data-qmeta",n),e==="script"&&(a.innerHTML=l[n].innerHTML||""),document.head.appendChild(a)}}),Object.keys(t.htmlAttr).filter(O).forEach(e=>{document.documentElement.setAttribute(e,t.htmlAttr[e]||"")}),Object.keys(t.bodyAttr).filter(E).forEach(e=>{document.body.setAttribute(e,t.bodyAttr[e]||"")})}function Ee(){C=null;const t={title:"",titleTemplate:null,meta:{},link:{},script:{},htmlAttr:{},bodyAttr:{}};for(let o=0;o<w.length;o++){const{active:e,val:l}=w[o];e===!0&&be(!0,t,l)}Ae(t),$e(qe($,t)),$=t}function k(){C!==null&&clearTimeout(C),C=setTimeout(Ee,50)}function Oe(t){{const o={active:!0};if(typeof t=="function"){const e=i(t);o.val=e.value,M(e,l=>{o.val=l,o.active===!0&&k()})}else o.val=t;w.push(o),k(),ee(()=>{o.active=!0,k()}),te(()=>{o.active=!1,k()}),oe(()=>{w.splice(w.indexOf(o),1),k()})}}const Me={key:0,class:"q-ma-md"},je={class:"col-12 q-ma-md"},Ne=ne({__name:"NovelTitle",setup(t){const o=pe(),e=he(),l=e.isDebugMode,n=ae(),a=de(),r=I({novelTitle:"",coverImage:"",novelChapters:[],description:"",novelId:0,ownerId:0,ownerUsername:""}),s=I(!0),_=i(()=>o.isAuthenticated?o.user.username===r.value.ownerUsername:!1);M(()=>e.language,g=>{l&&console.debug(`language was changed to ${g}`),typeof n.params.novelId=="string"&&a.push({path:`/novel-title/${n.params.novelId}/${e.language}`}).then(()=>{b()}).catch(c=>{console.error(c)})});const m=I(!1);function b(){if(typeof n.params.novelId=="string"){const g=`/novels/${n.params.novelId}/${e.language}/`;s.value=!0,ge.get(g).then(c=>{const f=c.data;console.debug(f),r.value=Ie(f),l&&console.debug(o.user.pk),r.value.ownerId==o.user.pk&&(m.value=!0,l&&console.debug("owner view"))}).catch(c=>{console.log(c)}).finally(()=>{s.value=!1,Oe({title:r.value.novelTitle})})}else return}return le(()=>{l&&console.debug(n.params.novelId),n.params.language!==void 0&&(e.language=n.params.language.toString()),b()}),(g,c)=>(S(),re(ve,{class:""},{default:ue(()=>[_.value?(S(),se("div",Me,[q(xe,{modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=f=>m.value=f),label:"owner view"},null,8,["modelValue"])])):ie("",!0),ce("div",je,[q(ke,{novelTitle:r.value.novelTitle,coverImage:r.value.coverImage,novelChapters:r.value.novelChapters,description:r.value.description,novelId:r.value.novelId,"owner-id":r.value.ownerId,"owner-username":r.value.ownerUsername,imageLinksToImageDetail:!1,"show-owner-menu":m.value,onImageUpdated:b},null,8,["novelTitle","coverImage","novelChapters","description","novelId","owner-id","owner-username","show-owner-menu"])])]),_:1}))}}),it=we(Ne,[["__scopeId","data-v-8c518703"]]);export{it as default};
