import{Q as b,a as m,b as x}from"./QForm-D5fUjBGa.js";import{a as q}from"./QBtn-ByhOyUu0.js";import{Q as V}from"./QCardSection-fCPM5_8n.js";import{Q as k}from"./QCard-CnZ4-XBm.js";import{Q as C}from"./QPage-Duaz2w7T.js";import{i as _,$ as B,B as N,r as n,C as p,E as l,D as f,G as o,N as i,I as g,a0 as P,F as S,J as E,M as L}from"./index-cC71wtJX.js";import{u as A,A as U}from"./axios-BbYGcbgs.js";import"./vm-Dh9uk0XM.js";import"./use-dark-UWwDjk9e.js";function D(){return _(B)}const K=N({__name:"UserLogin",setup(I){const t=n(""),u=n(""),c=n(!1),r=n(""),v=A(),d=L(),y=D(),w=async()=>{c.value=!0,r.value="";try{await v.login({email:t.value,username:t.value,password:u.value}),console.log("login success"),d.push("/").catch(e=>{console.error("navigation after logging in failed",e)})}catch(e){let a="Login failed. Please check your credentials or try again later.";if(e instanceof U)if(e.response&&e.response.data){const s=e.response.data;s&&typeof s.message=="string"?a=s.message:s&&typeof s.error=="string"?a=s.error:typeof s=="string"?a=s:e.message&&(a=e.message)}else e.request?a="No response from server. Please check your network connection.":a=e.message||"An unexpected error occurred during the request setup.";else e instanceof Error?a=e.message:typeof e=="string"&&(a=e);r.value=a,y.notify({color:"negative",position:"top",message:r.value,icon:"warning"})}finally{c.value=!1}},h=()=>{d.push("user-sign-up").catch(e=>console.log(e))},Q=()=>{d.push("user-sign-up").catch(e=>console.log(e))};return(e,a)=>(f(),p(C,{class:"flex"},{default:l(()=>[o(k,{flat:"",style:{width:"400px","max-width":"90vw"}},{default:l(()=>[o(V,null,{default:l(()=>[i("div",{class:"text-h5 q-mb-md"},[a[2]||(a[2]=g("Login or ")),i("a",{class:"",onClick:h},"sing up")]),o(b,{onSubmit:P(w,["prevent"])},{default:l(()=>[o(m,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value=s),label:"Email",type:"email",filled:"","lazy-rules":"",rules:[s=>!!s||"Email is required",s=>/.+@.+\..+/.test(s)||"Invalid email"],class:"q-mb-sm"},null,8,["modelValue","rules"]),o(m,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=s=>u.value=s),label:"Password",type:"password",filled:"","lazy-rules":"",rules:[s=>!!s||"Password is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),r.value?(f(),p(x,{key:0,"inline-actions":"",class:"text-white bg-red q-mb-md"},{default:l(()=>[g(E(r.value),1)]),_:1})):S("",!0),i("div",null,[o(q,{label:"Login",type:"submit",color:"primary",loading:c.value,class:"full-width"},null,8,["loading"]),i("a",{class:"",onClick:Q},"reset password")])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{K as default};
