import{Q}from"./QInput-D1yerHDM.js";import{Q as y,a as _}from"./QForm-BvKcPOpk.js";import{Q as g}from"./QBtn-B5SE2Hf0.js";import{Q as h}from"./QCardSection-DcDrDFzx.js";import{Q as b}from"./QCard-JW6x90ft.js";import{Q as x}from"./QPage-DlsySsfg.js";import{L as V,r as a,I as R,a0 as k,M as p,O as o,N as m,Q as t,W as c,ae as q,P as N,R as B,S as C,V as P}from"./index-Dz4WaEOw.js";import{a as M}from"./auth-AG_PkWnV.js";import"./use-key-composition--4J_daTu.js";import"./use-router-link-CWDQuq44.js";import"./use-dark-B67S6ShJ.js";import"./private.use-form-BgCsA4Eb.js";const G=V({__name:"UserPasswordReset",setup(S){const w=k(),f=P(),l=a(""),u=a(null),n=a(null),d=a(!1),s=a(""),v=async()=>{d.value=!0,s.value="",await M.post("auth/password/reset/confirm/",{new_password1:l.value,new_password2:l.value,uid:u.value,token:n.value}).then(()=>{f.push("/user-login").catch(e=>{console.error(e)})}).catch(e=>{console.error(e),s.value="Failed to reset password. ",e.response.data.new_password2!==void 0&&(s.value+=e.response.data.new_password2+" ")}).finally(()=>{d.value=!1})};return R(()=>{const e=w.query.url;n.value=e.split("/")[7],u.value=e.split("/")[6],console.log("passwordResetUrl",e),console.debug("uid",u.value),console.debug("token",n.value)}),(e,r)=>(m(),p(x,{class:"flex"},{default:o(()=>[t(b,{flat:"",style:{width:"400px","max-width":"90vw"}},{default:o(()=>[t(h,{class:"q-my-md"},{default:o(()=>[r[1]||(r[1]=c("div",{class:"text-h5 q-mb-md"},"Enter new password",-1)),t(y,{onSubmit:q(v,["prevent"])},{default:o(()=>[t(Q,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),label:"New password",type:"password",filled:"","lazy-rules":"",rules:[i=>!!i||"Password is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s.value?(m(),p(_,{key:0,"inline-actions":"",class:"text-white bg-red q-my-md"},{default:o(()=>[B(C(s.value),1)]),_:1})):N("",!0),c("div",null,[t(g,{label:"Reset password",type:"submit",color:"primary",loading:d.value,class:"full-width"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{G as default};
