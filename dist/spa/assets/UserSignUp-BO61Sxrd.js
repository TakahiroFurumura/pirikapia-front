import{Q as m}from"./QInput-KBLoUKGC.js";import{Q as y,a as b}from"./QForm-v5x6QR7H.js";import{Q}from"./QBtn-CLxMaHe1.js";import{Q as V}from"./QCardSection-D0VnWluj.js";import{Q as h}from"./QCard-7iG2TEtr.js";import{Q as x}from"./QPage-DwCQTNlA.js";import{B as S,r as t,C as p,E as o,D as f,G as s,N as c,a7 as q,F as U,I as B,J as C,M as _}from"./index-BezVK7cR.js";import{u as N,a as F}from"./axios-XIaLQy-R.js";import"./use-router-link-DPzGpGDy.js";import"./use-dark-n9fOPvqj.js";const T=S({__name:"UserSignUp",setup(k){const v=N(),i=t(""),n=t(""),u=t(""),d=t(!1),l=t(""),g=_(),w=async()=>{d.value=!0,l.value="";try{const r={username:n.value,email:i.value,password1:u.value,password2:u.value};await F.post("/auth/registration/",r).then(a=>{a.status===201?(v._setAuthData(a.data.access,a.data.refresh,a.data.user),g.push("/").catch(e=>{console.error("navigation after logging in failed",e)})):l.value="Failed to create a new account. "+a.data.toString()}).catch(a=>{console.log(a),l.value="Failed to create a new account. ",a.response.data.email!==void 0&&(l.value+=a.response.data.email+" "),a.response.data.password!==void 0&&(l.value+=a.response.data.password+" "),a.response.data.username!==void 0&&(l.value+=a.response.data.username+" ")}).finally()}catch(r){console.log(r)}finally{d.value=!1}};return(r,a)=>(f(),p(x,{class:"flex"},{default:o(()=>[s(h,{flat:"",style:{width:"400px","max-width":"90vw"}},{default:o(()=>[s(V,null,{default:o(()=>[a[3]||(a[3]=c("div",{class:"text-h5 q-mb-md"},"Sing up",-1)),s(y,{onSubmit:q(w,["prevent"])},{default:o(()=>[s(m,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),label:"Email",type:"email",filled:"","lazy-rules":"",rules:[e=>!!e||"Email is required",e=>/.+@.+\..+/.test(e)||"Invalid email"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s(m,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),label:"User name (displayed publicly)",type:"text",filled:"","lazy-rules":"",rules:[e=>!!e||"User name is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s(m,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value=e),label:"Password",type:"password",filled:"","lazy-rules":"",rules:[e=>!!e||"Password is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),l.value?(f(),p(b,{key:0,"inline-actions":"",class:"text-white bg-red q-mb-md"},{default:o(()=>[B(C(l.value),1)]),_:1})):U("",!0),c("div",null,[s(Q,{label:"Sign up",type:"submit",color:"primary",loading:d.value,class:"full-width"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{T as default};
