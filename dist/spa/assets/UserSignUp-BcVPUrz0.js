import{Q as w,a as m,b}from"./QForm-D5fUjBGa.js";import{a as V}from"./QBtn-ByhOyUu0.js";import{Q as h}from"./QCardSection-fCPM5_8n.js";import{Q}from"./QCard-CnZ4-XBm.js";import{Q as x}from"./QPage-Duaz2w7T.js";import{B as S,r as t,C as p,E as s,D as c,G as l,N as f,a0 as q,F as U,I as B,J as C,M as _}from"./index-cC71wtJX.js";import{u as N,a as k}from"./axios-BbYGcbgs.js";import"./vm-Dh9uk0XM.js";import"./use-dark-UWwDjk9e.js";const L=S({__name:"UserSignUp",setup(z){const v=N(),i=t(""),n=t(""),r=t(""),d=t(!1),o=t(""),g=_(),y=async()=>{d.value=!0,o.value="";try{const u={username:n.value,email:i.value,password1:r.value,password2:r.value};await k.post("/auth/registration/",u).then(e=>{e.status===201?(v._setAuthData(e.data.access,e.data.refresh,e.data.user),g.push("/").catch(a=>{console.error("navigation after logging in failed",a)})):o.value="Failed to create a new account. "+e.data.toString()}).catch(e=>{console.log(e.response.data)}).finally()}catch(u){console.log(u)}finally{d.value=!1}};return(u,e)=>(c(),p(x,{class:"flex"},{default:s(()=>[l(Q,{flat:"",style:{width:"400px","max-width":"90vw"}},{default:s(()=>[l(h,null,{default:s(()=>[e[3]||(e[3]=f("div",{class:"text-h5 q-mb-md"},"Sing up",-1)),l(w,{onSubmit:q(y,["prevent"])},{default:s(()=>[l(m,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),label:"Email",type:"email",filled:"","lazy-rules":"",rules:[a=>!!a||"Email is required",a=>/.+@.+\..+/.test(a)||"Invalid email"],class:"q-mb-sm"},null,8,["modelValue","rules"]),l(m,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),label:"User name (displayed publicly)",type:"text",filled:"","lazy-rules":"",rules:[a=>!!a||"User name is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),l(m,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),label:"Password",type:"password",filled:"","lazy-rules":"",rules:[a=>!!a||"Password is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),o.value?(c(),p(b,{key:0,"inline-actions":"",class:"text-white bg-red q-mb-md"},{default:s(()=>[B(C(o.value),1)]),_:1})):U("",!0),f("div",null,[l(V,{label:"Login",type:"submit",color:"primary",loading:d.value,class:"full-width"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{L as default};
