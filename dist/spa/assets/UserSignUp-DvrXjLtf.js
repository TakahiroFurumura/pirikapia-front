import{Q as y,a as m,b}from"./QForm-CHBwPtrE.js";import{a as V}from"./QBtn-BZqyzzDW.js";import{Q as h}from"./QCardSection-DBV8wOnY.js";import{Q}from"./QCard-BarK22sE.js";import{Q as x}from"./QPage-IvwbS32v.js";import{B as S,r as t,C as p,E as o,D as c,G as s,N as f,a1 as q,F as U,I as B,J as C,M as _}from"./index-BRBNf_uG.js";import{u as N,a as F}from"./axios-B-LYouSp.js";import"./use-dark-BiamoCnD.js";import"./render-AV_9SGo9.js";const R=S({__name:"UserSignUp",setup(k){const v=N(),i=t(""),n=t(""),u=t(""),d=t(!1),l=t(""),g=_(),w=async()=>{d.value=!0,l.value="";try{const r={username:n.value,email:i.value,password1:u.value,password2:u.value};await F.post("/auth/registration/",r).then(a=>{a.status===201?(v._setAuthData(a.data.access,a.data.refresh,a.data.user),g.push("/").catch(e=>{console.error("navigation after logging in failed",e)})):l.value="Failed to create a new account. "+a.data.toString()}).catch(a=>{console.log(a),l.value="Failed to create a new account. ",a.response.data.email!==void 0&&(l.value+=a.response.data.email+" "),a.response.data.password!==void 0&&(l.value+=a.response.data.password+" "),a.response.data.username!==void 0&&(l.value+=a.response.data.username+" ")}).finally()}catch(r){console.log(r)}finally{d.value=!1}};return(r,a)=>(c(),p(x,{class:"flex"},{default:o(()=>[s(Q,{flat:"",style:{width:"400px","max-width":"90vw"}},{default:o(()=>[s(h,null,{default:o(()=>[a[3]||(a[3]=f("div",{class:"text-h5 q-mb-md"},"Sing up",-1)),s(y,{onSubmit:q(w,["prevent"])},{default:o(()=>[s(m,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),label:"Email",type:"email",filled:"","lazy-rules":"",rules:[e=>!!e||"Email is required",e=>/.+@.+\..+/.test(e)||"Invalid email"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s(m,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),label:"User name (displayed publicly)",type:"text",filled:"","lazy-rules":"",rules:[e=>!!e||"User name is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s(m,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value=e),label:"Password",type:"password",filled:"","lazy-rules":"",rules:[e=>!!e||"Password is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),l.value?(c(),p(b,{key:0,"inline-actions":"",class:"text-white bg-red q-mb-md"},{default:o(()=>[B(C(l.value),1)]),_:1})):U("",!0),f("div",null,[s(V,{label:"Sign up",type:"submit",color:"primary",loading:d.value,class:"full-width"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{R as default};
