import{Q as m}from"./QInput-D4vvrlNf.js";import{Q as y,a as Q}from"./QForm-CotXv285.js";import{Q as V}from"./QBtn-BI7MwTIZ.js";import{Q as b}from"./QCardSection-D2WMBtB8.js";import{Q as h}from"./QCard-mhFZGvGd.js";import{Q as S}from"./QPage-8dP9sEj4.js";import{L as x,r as t,M as p,O as o,N as f,Q as s,W as c,ae as q,P as U,R as _,S as B,V as C}from"./index-BJX9CnoD.js";import{u as N,a as P}from"./auth-Dd1rHt8x.js";import"./use-key-composition-Bk0-abQY.js";import"./use-router-link-x6n-tYgq.js";import"./use-dark-V88JdNWz.js";import"./private.use-form-DBK12ClL.js";const j=x({__name:"UserSignUp",setup(k){const v=N(),i=t(""),n=t(""),r=t(""),d=t(!1),l=t(""),g=C(),w=async()=>{d.value=!0,l.value="";try{const u={username:n.value,email:i.value,password1:r.value,password2:r.value};await P.post("/auth/registration/",u).then(a=>{a.status===201?(v._setAuthData(a.data.access,a.data.refresh,a.data.user),g.push("/").catch(e=>{console.error("navigation after logging in failed",e)})):l.value="Failed to create a new account. "+a.data.toString()}).catch(a=>{console.log(a),l.value="Failed to create a new account. ",a.response.data.email!==void 0&&(l.value+=a.response.data.email+" "),a.response.data.password!==void 0&&(l.value+=a.response.data.password+" "),a.response.data.username!==void 0&&(l.value+=a.response.data.username+" ")}).finally()}catch(u){console.log(u)}finally{d.value=!1}};return(u,a)=>(f(),p(S,{class:"flex"},{default:o(()=>[s(h,{flat:"",style:{width:"400px","max-width":"90vw"}},{default:o(()=>[s(b,null,{default:o(()=>[a[3]||(a[3]=c("div",{class:"text-h5 q-mb-md"},"Sing up",-1)),s(y,{onSubmit:q(w,["prevent"])},{default:o(()=>[s(m,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),label:"Email",type:"email",filled:"","lazy-rules":"",rules:[e=>!!e||"Email is required",e=>/.+@.+\..+/.test(e)||"Invalid email"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s(m,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),label:"User name (displayed publicly)",type:"text",filled:"","lazy-rules":"",rules:[e=>!!e||"User name is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),s(m,{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),label:"Password",type:"password",filled:"","lazy-rules":"",rules:[e=>!!e||"Password is required"],class:"q-mb-sm"},null,8,["modelValue","rules"]),l.value?(f(),p(Q,{key:0,"inline-actions":"",class:"text-white bg-red q-mb-md"},{default:o(()=>[_(B(l.value),1)]),_:1})):U("",!0),c("div",null,[s(V,{label:"Sign up",type:"submit",color:"primary",loading:d.value,class:"full-width"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1}))}});export{j as default};
