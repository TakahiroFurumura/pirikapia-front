import{a,c as k,r as s,K as M,I as E,h as n,w as F,T as O,d as K}from"./index-DDJCu69c.js";import{f as U,h as W,i as x}from"./QBtn-CT6Dl0K4.js";import{d as _,h as I}from"./use-router-link-CdVA7K5L.js";import{u as q}from"./use-timeout-DOCYTK08.js";const G={ratio:[String,Number]};function J(e,t){return a(()=>{const o=Number(e.ratio||(t!==void 0?t.value:void 0));return isNaN(o)!==!0&&o>0?{paddingBottom:`${100/o}%`}:null})}const V=1.7778,ee=k({name:"QImg",props:{...G,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:V},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:o}){const c=s(e.initialRatio),y=J(e,c),v=K(),{registerTimeout:N,removeTimeout:f}=q(),{registerTimeout:R,removeTimeout:b}=q(),h=a(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),z=a(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),r=[s(null),s(h.value)],l=s(0),g=s(!1),d=s(!1),L=a(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),w=a(()=>({width:e.width,height:e.height})),B=a(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),P=a(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function Q(){if(b(),e.loadingShowDelay===0){g.value=!0;return}R(()=>{g.value=!0},e.loadingShowDelay)}function S(){b(),g.value=!1}function $({target:i}){_(v)===!1&&(f(),c.value=i.naturalHeight===0?.5:i.naturalWidth/i.naturalHeight,T(i,1))}function T(i,u){u===1e3||_(v)===!0||(i.complete===!0?A(i):N(()=>{T(i,u+1)},50))}function A(i){_(v)!==!0&&(l.value=l.value^1,r[l.value].value=null,S(),i.getAttribute("__qerror")!=="true"&&(d.value=!1),o("load",i.currentSrc||i.src))}function j(i){f(),S(),d.value=!0,r[l.value].value=z.value,r[l.value^1].value=h.value,o("error",i)}function C(i){const u=r[i].value,m={key:"img_"+i,class:B.value,style:P.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...u};return l.value===i?Object.assign(m,{class:m.class+"current",onLoad:$,onError:j}):m.class+="loaded",n("div",{class:"q-img__container absolute-full",key:"img"+i},n("img",m))}function H(){return g.value===!1?n("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},I(t[d.value===!0?"error":"default"])):n("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[n(U,{color:e.spinnerColor,size:e.spinnerSize})])}{let i=function(){F(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,u=>{f(),d.value=!1,u===null?(S(),r[l.value^1].value=h.value):Q(),r[l.value].value=u},{immediate:!0})};M.value===!0?E(i):i()}return()=>{const i=[];return y.value!==null&&i.push(n("div",{key:"filler",style:y.value})),r[0].value!==null&&i.push(C(0)),r[1].value!==null&&i.push(C(1)),i.push(n(O,{name:"q-transition--fade"},H)),n("div",{key:"main",class:L.value,style:w.value,role:"img","aria-label":e.alt},i)}}}),ie=k({name:"QCardActions",props:{...W,vertical:Boolean},setup(e,{slots:t}){const o=x(e),c=a(()=>`q-card__actions ${o.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>n("div",{class:c.value},I(t.default))}});function te(e){return{filename:e.filename,image_id:e.image_id,signed_url:e.signed_url,owner_username:e.owner_username,title:"",favorite_count:0,comment_count:0,requires_login:e.requires_login,bookmark:e.bookmark,bookmark_count:e.bookmark_count}}function X(e){return{novelId:e.novel_title_id,chapterStrId:e.chapter_str_id,chapterTitle:e.chapter_title,coverImage:e.cover_image,description:e.chapter_description}}function ne(e){return{novelTitle:e.novel_title,coverImage:e.cover_image,novelChapters:e.novel_chapters.map(t=>X(t)),description:e.description,novelId:e.novel_id,ownerId:e.owner_id,ownerUsername:e.owner_username}}export{ee as Q,te as a,ie as b,ne as c};
